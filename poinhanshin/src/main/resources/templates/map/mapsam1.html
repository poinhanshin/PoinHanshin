<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
  <title>지도와 위시리스트</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: #f5f5f5;
    }
    h1 {
      text-align: center;
      padding: 20px;
    }
    #content {
      display: flex;
      flex-direction: column;
      padding: 20px;
    }

    #wishlist {
      width: 40%;
      padding: 20px;
      background-color: #f9f9f9;
      position: relative;
    }

    #searchInput {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
    }
    #map {
      width: 50%;
      height: 500px;
      margin-bottom: 20px;
    }
    #wishlist {
      width: 50%;
      background-color: #fff;
      padding: 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    li {
      margin-bottom: 10px;
      cursor: pointer;
      padding: 5px;
      background-color: #fff;
      border: 1px solid #ccc;
      transition: background-color 0.3s;
    }
    li:hover {
      background-color: #f5f5f5;
    }
    input[type="text"] {
      width: 50%;
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
    }
    button {
      padding: 8px 12px;
      background-color: #007bff;
      color: #fff;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    #searchResults {
      border: 1px solid #ccc;
      background-color: #fff;
      max-height: 150px;
      overflow-y: auto;
      padding: 10px;
      position: absolute;
      z-index: 1000;
      width: 250px;
      display: none;
    }
    #searchResults li {
      padding: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    #searchResults li:hover {
      background-color: #f5f5f5;
    }
    searchInput {
      position: relative;
      width: 50%;
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
    }
    #category {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    .category-selector {
      width: 48%;
      padding: 8px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
<h1>지도와 위시리스트</h1>
<div id="content">
  <div id="category">
    <select class="category-selector">
      <option value="강아지">강아지</option>
      <option value="고양이">고양이</option>
    </select>
    <select class="category-selector">
      <option value="신고자">신고자</option>
      <option value="발견자">발견자</option>
    </select>
  </div>
  </div>
  <div id="map"></div>
  <div id="wishlist">
    <h2>위시리스트 목록</h2>
    <ul id="placesList">
      <!-- 위시리스트 항목이 여기에 동적으로 추가될 예정 -->
    </ul>
    <div>
      <input type="text" id="newPlaceName" placeholder="장소명">
      <input type="text" id="newPlaceLat" placeholder="위도">
      <input type="text" id="newPlaceLng" placeholder="경도">
      <button id="addPlaceButton">추가</button>
    </div>
  </div>
</div>
<script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=c4fc6b86f6659d02a7d040b2f3536a81&libraries=services"></script>
<script>
  var places = [
    {
      name: '카페 A',
      latlng: new kakao.maps.LatLng(37.5665, 126.9780), // 예시 좌표
      description: '카페 A는 아늑한 분위기의 커피 전문점입니다. 다양한 음료와 디저트를 즐길 수 있습니다.'
    },
    {
      name: '레스토랑 B',
      latlng: new kakao.maps.LatLng(37.5670, 126.9790), // 예시 좌표
      description: '레스토랑 B는 현지 식재료를 사용한 다양한 요리를 제공합니다.'
    },
    // 추가적인 장소 정보 추가
  ];

  var mapContainer = document.getElementById('map');
  var mapOption = {
    center: new kakao.maps.LatLng(37.5665, 126.9780), // 지도 중심 좌표 (서울)
    level: 4 // 지도 확대 레벨
  };

  // 지도 생성
  var map = new kakao.maps.Map(mapContainer, mapOption);

  var placesList = document.getElementById('placesList');
  var addPlaceButton = document.getElementById('addPlaceButton');
  var newPlaceName = document.getElementById('newPlaceName');
  var newPlaceLat = document.getElementById('newPlaceLat');
  var newPlaceLng = document.getElementById('newPlaceLng');

  // 마커와 팝업 생성
  function createMarkerAndPopup(place) {
    var marker = new kakao.maps.Marker({
      map: map,
      position: place.latlng,
      title: place.name
    });

    var infowindow = new kakao.maps.InfoWindow({
      content: `
                <div style="padding:10px;">
                    <h3>${place.name}</h3>
                    <p>${place.description}</p>
                </div>
            `
    });

    kakao.maps.event.addListener(marker, 'click', function() {
      infowindow.open(map, marker);
    });

    kakao.maps.event.addListener(map, 'click', function() {
      infowindow.close();
    });

    return marker;
  }

  // 위시리스트에 있는 장소 목록과 마커 생성
  function renderPlaces() {
    placesList.innerHTML = '';
    for (var i = 0; i < places.length; i++) {
      var listItem = document.createElement('li');
      listItem.textContent = places[i].name;
      listItem.addEventListener('click', function() {
        var index = Array.from(placesList.children).indexOf(this);
        map.setCenter(places[index].latlng);
      });
      placesList.appendChild(listItem);

      createMarkerAndPopup(places[i]);
    }
  }

  // 초기 위시리스트 렌더링
  renderPlaces();

  // 장소 추가 버튼 클릭 시 실행
  addPlaceButton.addEventListener('click', function() {
    var newName = newPlaceName.value;
    var newLat = parseFloat(newPlaceLat.value);
    var newLng = parseFloat(newPlaceLng.value);
    if (newName && !isNaN(newLat) && !isNaN(newLng)) {
      var newLatlng = new kakao.maps.LatLng(newLat, newLng);
      places.push({ name: newName, latlng: newLatlng });
      newPlaceName.value = '';
      newPlaceLat.value = '';
      newPlaceLng.value = '';
      renderPlaces();
    } else {
      alert('올바른 값을 입력하세요.');
    }
  });

  // 지도 클릭 시 실행
  kakao.maps.event.addListener(map, 'click', function(mouseEvent) {
    var latlng = mouseEvent.latLng;
    var placeName = prompt('추가할 장소의 이름을 입력하세요:');
    if (placeName) {
      places.push({ name: placeName, latlng: latlng });
      renderPlaces();
    }
  });




  // 장소 검색 기능 추가
  var searchInput = document.createElement('input');
  searchInput.type = 'text';
  searchInput.id = 'searchInput';
  searchInput.style.position = 'relative';
  searchInput.style.padding = '8px';
  searchInput.style.width = '50%';
  searchInput.style.marginBottom = '10px';
  searchInput.style.border = '1px soild #ccc';
  searchInput.placeholder = '장소를 검색하세요';
  mapContainer.parentNode.insertBefore(searchInput, mapContainer);

  var placesService = new kakao.maps.services.Places();

  var searchResults = document.createElement('ul');
  searchResults.id = 'searchResults';
  searchResults.style.listStyle = 'none';
  searchResults.style.padding = '0';
  searchResults.style.marginTop = '10px';
  searchResults.style.border = '1px solid #ccc';
  searchResults.style.backgroundColor = '#fff';
  searchResults.style.maxHeight = '150px';
  searchResults.style.overflowY = 'auto';
  searchResults.style.padding = '10px';
  searchResults.style.position = 'absolute';
  searchResults.style.zIndex = '1000';
  searchResults.style.width = '250px';
  searchResults.style.display = 'none';
  mapContainer.parentNode.insertBefore(searchResults, mapContainer);

  searchInput.addEventListener('input', function() {
    var keyword = searchInput.value;
    if (keyword) {
      placesService.keywordSearch(keyword, function(result, status) {
        if (status === kakao.maps.services.Status.OK) {
          displaySearchResults(result);
        }
      });
    } else {
      searchResults.style.display = 'none';
    }
  });

  function displaySearchResults(results) {
    searchResults.innerHTML = '';
    for (var i = 0; i < results.length; i++) {
      var resultItem = document.createElement('li');
      resultItem.textContent = results[i].place_name;
      resultItem.style.cursor = 'pointer';
      resultItem.addEventListener('click', function() {
        var index = Array.from(searchResults.children).indexOf(this);
        var selectedPlace = results[index];
        var latlng = new kakao.maps.LatLng(selectedPlace.y, selectedPlace.x);
        places.push({ name: selectedPlace.place_name, latlng: latlng });
        renderPlaces();
        searchResults.style.display = 'none';
      });
      searchResults.appendChild(resultItem);
    }
    searchResults.style.display = 'block';
  }

  function createMarkerAndPopup(place) {
    var marker = new kakao.maps.Marker({
      map: map,
      position: place.latlng,
      title: place.name
    });

    var infowindow = new kakao.maps.InfoWindow({
      content: `
      <div style="padding:10px;">
        <h3>${place.name}</h3>
        <p>${place.description}</p>
      </div>
    `
    });

    kakao.maps.event.addListener(marker, 'click', function() {
      infowindow.open(map, marker);

      // 마커 클릭 시 게시물 정보를 표시하거나 이동하는 코드를 추가합니다.
      // 여기에서는 간단히 alert로 게시물 정보를 표시하는 예제를 제공합니다.
      alert('게시물 이름: ' + place.name + '\n게시물 설명: ' + place.description);
    });

    kakao.maps.event.addListener(map, 'click', function() {
      infowindow.close();
    });

    return marker;
  }
</script>
</body>
</html>